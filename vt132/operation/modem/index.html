<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>&#39;AT&#39; (Hayes) Serial Modem Operation Manual (Draft) | The High Nibble</title>
    <meta name="description" content="">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-JVDLCQSGXK"></script>
  <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-JVDLCQSGXK');</script>
  <script type="module" src="https://unpkg.com/esp-web-tools@9.2.0/dist/web/install-button.js?module"></script>
    
    <link rel="preload" href="/assets/css/0.styles.c1e91812.css" as="style"><link rel="preload" href="/assets/js/app.a4ca7be3.js" as="script"><link rel="preload" href="/assets/js/23.285a1bb3.js" as="script"><link rel="prefetch" href="/assets/js/10.a1761c1b.js"><link rel="prefetch" href="/assets/js/11.ec577dca.js"><link rel="prefetch" href="/assets/js/12.7c10a1e9.js"><link rel="prefetch" href="/assets/js/13.1cf8bcce.js"><link rel="prefetch" href="/assets/js/14.19ffffca.js"><link rel="prefetch" href="/assets/js/15.ddf97691.js"><link rel="prefetch" href="/assets/js/16.686f89aa.js"><link rel="prefetch" href="/assets/js/17.b0cfdf99.js"><link rel="prefetch" href="/assets/js/18.31ce3cae.js"><link rel="prefetch" href="/assets/js/19.ea9ef856.js"><link rel="prefetch" href="/assets/js/2.d719985f.js"><link rel="prefetch" href="/assets/js/20.5e9cab50.js"><link rel="prefetch" href="/assets/js/21.8975c554.js"><link rel="prefetch" href="/assets/js/22.ed3f4f05.js"><link rel="prefetch" href="/assets/js/24.56b64d35.js"><link rel="prefetch" href="/assets/js/25.9f6ad8a0.js"><link rel="prefetch" href="/assets/js/26.4fb4d175.js"><link rel="prefetch" href="/assets/js/27.6fa96bf1.js"><link rel="prefetch" href="/assets/js/28.ec99adc6.js"><link rel="prefetch" href="/assets/js/29.94ecc810.js"><link rel="prefetch" href="/assets/js/3.c9e8ee06.js"><link rel="prefetch" href="/assets/js/30.a5b1fc7f.js"><link rel="prefetch" href="/assets/js/31.6b6ed39c.js"><link rel="prefetch" href="/assets/js/32.8285d7d9.js"><link rel="prefetch" href="/assets/js/33.f36dfd73.js"><link rel="prefetch" href="/assets/js/4.bdb612dd.js"><link rel="prefetch" href="/assets/js/5.2c851482.js"><link rel="prefetch" href="/assets/js/6.5265986f.js"><link rel="prefetch" href="/assets/js/7.681fd166.js"><link rel="prefetch" href="/assets/js/8.6df93b9e.js"><link rel="prefetch" href="/assets/js/9.761efa14.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c1e91812.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">The High Nibble</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/imsai8080/" class="nav-link">IMSAI 8080</a></div><div class="nav-item"><a href="/cromemcoZ1/" class="nav-link">Cromemco Z-1</a></div><div class="nav-item"><a href="/vt132/" class="nav-link router-link-active">VT132</a></div><div class="nav-item"><a href="/s132/" class="nav-link">S-132</a></div><div class="nav-item"><a href="https://github.com/orgs/thehighnibble/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/thehighnibble/firmware" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/imsai8080/" class="nav-link">IMSAI 8080</a></div><div class="nav-item"><a href="/cromemcoZ1/" class="nav-link">Cromemco Z-1</a></div><div class="nav-item"><a href="/vt132/" class="nav-link router-link-active">VT132</a></div><div class="nav-item"><a href="/s132/" class="nav-link">S-132</a></div><div class="nav-item"><a href="https://github.com/orgs/thehighnibble/discussions" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/thehighnibble/firmware" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>'AT' (Hayes) Serial Modem Operation Manual (Draft)</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/vt132/operation/modem/#background" class="sidebar-link">Background</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vt132/operation/modem/#at-commands" class="sidebar-link">'AT' Commands</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vt132/operation/modem/#at-command-help" class="sidebar-link">'AT' Command Help</a></li><li class="sidebar-sub-header"><a href="/vt132/operation/modem/#at-command-summary-table" class="sidebar-link">'AT' Command Summary Table</a></li></ul></li><li><a href="/vt132/operation/modem/#s-registers" class="sidebar-link">'S' Registers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vt132/operation/modem/#defined-s-registers" class="sidebar-link">Defined 'S' Registers</a></li></ul></li><li><a href="/vt132/operation/modem/#wi-fi-connection-results" class="sidebar-link">Wi-Fi Connection Results</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vt132/operation/modem/#dial-responses" class="sidebar-link">Dial Responses</a></li><li class="sidebar-sub-header"><a href="/vt132/operation/modem/#query-wi-fi-responses" class="sidebar-link">Query Wi-Fi Responses</a></li></ul></li><li><a href="/vt132/operation/modem/#telnet-protocol" class="sidebar-link">Telnet Protocol</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vt132/operation/modem/#telnet-options-implemented" class="sidebar-link">Telnet Options Implemented</a></li><li class="sidebar-sub-header"><a href="/vt132/operation/modem/#enabling-telnet-protocol" class="sidebar-link">Enabling Telnet Protocol</a></li><li class="sidebar-sub-header"><a href="/vt132/operation/modem/#telnet-protocol-framework" class="sidebar-link">Telnet Protocol Framework</a></li></ul></li><li><a href="/vt132/operation/modem/#answer-mode" class="sidebar-link">Answer Mode</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="at-hayes-serial-modem-operation-manual-draft"><a href="#at-hayes-serial-modem-operation-manual-draft" class="header-anchor">#</a> 'AT' (Hayes) Serial Modem Operation Manual (Draft)</h1> <h2 id="background"><a href="#background" class="header-anchor">#</a> Background</h2> <p>Unlike the VT100 terminal, the modem does not try to faithfully emulate any particular original device.</p> <p>Instead it is designed to provide an MVP (minimum viable product) providing a modified <a href="https://en.wikipedia.org/wiki/Hayes_command_set" target="_blank" rel="noopener noreferrer">Hayes 'AT'<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <strong>compatible</strong> command set for connecting over Wi-Fi via TCP/IP sockets with an optional <a href="https://en.wikipedia.org/wiki/Telnet" target="_blank" rel="noopener noreferrer">Telnet protocol<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> layer.</p> <p>Although later standardized by the TIA/EIA, in the early days of dialup modems the <strong>'AT' command set</strong> of the Hayes SmartModem was copied by other modem makers and became a de-facto standard or rather a <strong>convention</strong>, as other modem manufacturers took the liberty to alter and extend the 'AT' command set. The same applied to the so called <strong>'S' Registers</strong> where settings and configuration are made and saved to non-volatile storage (NVS).</p> <p>See <a href="/vt132/operation/#hardware-configuration">Hardware Configuration</a> for details on connecting from a UART on your system to the modem.</p> <h2 id="at-commands"><a href="#at-commands" class="header-anchor">#</a> 'AT' Commands</h2> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>The original 'AT' command set was strictly in upper case. This is because the bit sequence of the ASCII values for 'A' and 'T' have a specific property that enables <a href="https://en.wikipedia.org/wiki/Hayes_command_set#Autobaud" target="_blank" rel="noopener noreferrer">autobaud detection<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> of the connection to the data terminal equipment (DTE).</p> <ul><li>The modem only responds to 'AT' commands in upper case.</li></ul></div> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <ul><li>Commands are terminated by <code>&lt;CR&gt;</code> (carriage return, <code>&lt;ctrl&gt;-m</code>, <code>0x0D</code>, decimal 13) usually generated by the <code>Enter</code> or <code>Return</code> key on your keyboard.</li> <li>Commands can by edited, before pressing <code>&lt;CR&gt;</code>, using <code>&lt;BS&gt;</code> (backspace, <code>&lt;ctrl&gt;-H</code>, <code>0x08</code> decimal 8) to erase the previous character entered. You may need to configure the terminal to generate <code>&lt;BS&gt;</code> when you press the <code>Backspace</code> or <code>&lt;-</code> key on your keyboard.</li></ul></div> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>The 'AT' command processor is based on a finite state machine (FSM). If you type anything that is not recognized by the rules of the FSM you will immediately see an <code>Error</code> message.</p></div> <h3 id="at-command-help"><a href="#at-command-help" class="header-anchor">#</a> 'AT' Command Help</h3> <p>Typing <code>AT$</code> when connected to the modem will result in the following 'AT' command summary being returned by the modem.</p> <p><img src="/assets/img/Modem_AT_help.5f469d8f.jpg" alt="Modem AT Commands"></p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <ul><li>All commands must be prefixed with <code>AT</code> except for the <strong>immediate</strong> command <code>A/</code>.</li> <li>Commands can be concatenated into a single command string, except in the cases where the command accepts all the remaining input up to the <code>&lt;CR&gt;</code> as part of the command.</li> <li>See the table below for examples.</li></ul></div> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>The maximum length command string that can be entered is <strong>80</strong> characters.</p></div> <p>Each command is explained in the following table.</p> <h3 id="at-command-summary-table"><a href="#at-command-summary-table" class="header-anchor">#</a> 'AT' Command Summary Table</h3> <table><thead><tr><th>Command</th> <th>Description</th> <th>Comments/Examples</th></tr></thead> <tbody><tr><td><strong>AT</strong></td> <td>'AT' test</td> <td><code>AT</code> entered on its own will respond <code>OK</code> and tests that command processor is responding</td></tr> <tr><td><strong>A/</strong></td> <td>Repeat last command (immediate)</td> <td>This <strong>immediate</strong> command is <strong>not</strong> prefixed by <code>AT</code> but repeats the last command entered as soon as <code>A/</code> is entered ie. it does not wait for a <code>&lt;CR&gt;</code></td></tr> <tr><td><strong>$</strong></td> <td>Help</td> <td>Responds with the 'AT' Command Help <a href="#at-command-help">see above</a></td></tr> <tr><td><strong>I</strong> or <strong>I0</strong></td> <td>Information zero</td> <td>Responds with the modem model string <code>VT132 'AT' Modem</code></td></tr> <tr><td><strong>I1</strong></td> <td>Information one</td> <td>Responds with the modem firmware version string eg. <code>V1.0.0</code></td></tr> <tr><td><strong>I2</strong></td> <td>Information two</td> <td>Responds with the modem firmware build chain version string eg. <code>V4.0-1234</code></td></tr> <tr><td><strong>Z</strong></td> <td>Reset modem</td> <td>Soft resets the modem. Reloads settings and 'S' Registers from NVS. Closes open TCP/IP connections. But does not disconnect from the Wi-Fi Access Point (AP) if connected</td></tr> <tr><td><strong>&amp;F</strong></td> <td>Restore factory defaults</td> <td>Return the current settings and 'S' Registers to factory defaults. But does not save these to NVS</td></tr> <tr><td><strong>&amp;W</strong></td> <td>Write settings to NVS</td> <td>Writes the current settings to NVS. This takes approximately 10 seconds, during which the modem appears frozen. The modem will respond <code>OK</code> when the write is complete</td></tr> <tr><td><strong>D</strong></td> <td>Dial (TCP/IP connect)</td> <td>The full form is <code>ATDhostname:port</code> where <em>hostname</em> is either the IPV4 address in <code>nnn.nnn.nnn.nnn</code> notation or the DNS name of the host. The <code>:port</code> is optional and specifies a <em>numeric TCP/IP port number</em> for the connection, the default is <code>23</code>. There are a number of possible error conditions explained below under <a href="#wi-fi-connection-results">Wi-Fi Connection Results</a>. If the connection is successful the modem will enter <strong>Data Mode</strong></td></tr> <tr><td>+++</td> <td>Escape Sequence</td> <td>When connected and in <strong>Data Mode</strong> the <em>Escape Sequence</em> will return to <strong>Command Mode</strong>. The <code>+++</code> <em>Escape Sequence</em> is only recognised if surrounded by a guard interval of 1 second ie. there must be a one second pause before and after entering <code>+++</code> or it will not be recognised but simply treated as part of the data stream</td></tr> <tr><td><strong>O</strong></td> <td>Return Online</td> <td>When connected and in <strong>Command Mode</strong> <code>ATO</code> will return to <strong>Data Mode</strong>. If not connected the modem will respond <code>NO CARRIER</code></td></tr> <tr><td><strong>H</strong></td> <td>Hangup</td> <td>When connected and in <strong>Command Mode</strong> <code>ATH</code> will close the connection. If a connection is closed the modem will respond <code>HANGUP</code></td></tr> <tr><td><strong>&amp;A</strong> or <strong>&amp;A0</strong></td> <td>Enable Answer mode (interactive)</td> <td>Unless <code>AT&amp;A</code> is entered the modem will not respond to requests for incoming connections. See <a href="#answer-mode">Answer Mode</a> below for details. <strong>Interactive:</strong> Displays <code>RING</code> &amp; <code>CONNECTED</code> responses (if enabled). Allows the interrupt sequence <code>+++</code> to return the Modem to command mode from data mode</td></tr> <tr><td><strong>&amp;A1</strong></td> <td>Enable Answer mode (daemon)</td> <td>Unless <code>AT&amp;A</code> is entered the modem will not respond to requests for incoming connections. See <a href="#answer-mode">Answer Mode</a> below for details. <strong>Daemon:</strong> Suppresses 'AT' command echo and responses (sets <code>ATE0</code> &amp; <code>ATQ1</code>). Ignores the interrupt sequence <code>+++</code> preventing the Modem from returning to command mode from data mode</td></tr> <tr><td><strong>A</strong></td> <td>Answer</td> <td>When an incoming connection request is indicated by the modem responding <code>RING</code> the request can by manually accepted with the <code>ATA</code> command. If the connection is successful the modem will enter <strong>Data Mode</strong></td></tr> <tr><td><strong>Sn</strong></td> <td>Select current register</td> <td>Select register <em>n</em> as the current 'S' register</td></tr> <tr><td><strong>?</strong></td> <td>Query current register</td> <td>The modem will respond with the value of the current 'S' register. If no register has been selected the default is zero (0). As commands can be concatenated it is normal to append this to the <code>Sn</code> command to query a specific register eg. <code>ATS15?</code> will query the value of 'S' Register 15</td></tr> <tr><td><strong>=r</strong></td> <td>Set current register</td> <td>Sets the value of the current 'S' register to <em>r</em>. If no register has been selected the default is zero (0). As commands can be concatenated it is normal to append this to the <code>Sn</code> command to set a specific register eg. <code>ATS15=1</code> will set the value of 'S' Register 15 to 1</td></tr> <tr><td><strong>En</strong></td> <td>Command Echo</td> <td>Where <em>n=0</em> is echo off and <em>n=1</em> is echo on; to disable/enable echoing 'AT' commands when in command mode; default is <em>on</em> (echo on)</td></tr> <tr><td><strong>Qn</strong></td> <td>Quiet Results</td> <td>Where <em>n=0</em> is quiet off and <em>n=1</em> is quiet on; to show/hide 'AT' command results when in command mode; default is <em>off</em> (quiet off)</td></tr> <tr><td><strong>&amp;K</strong> or <strong>&amp;K0</strong></td> <td>Disable CTS/RTS flow control</td> <td>The 6-pin modem header provides CTS/RTS lines. <code>AT&amp;K0</code> disables their operation. This is the default</td></tr> <tr><td><strong>&amp;K1</strong></td> <td>Enable CTS/RTS flow control</td> <td>The 6-pin modem header provides CTS/RTS lines. <code>AT&amp;K1</code> enables their operation</td></tr> <tr><td><strong>+W?</strong></td> <td>Query Wi-Fi Access Point (AP) connection status</td> <td>Responds with the status of the Wi-Fi connection as a string. The possible responses are listed below under <a href="#wi-fi-connection-results">Wi-Fi Connection Results</a></td></tr> <tr><td><strong>+W=sss,ppp</strong></td> <td>Join Wi-Fi Access Point (AP)</td> <td>Connects to the Wi-Fi access point with <strong>SSID</strong> - <em>sss</em> and <strong>password</strong> - <em>ppp</em>. The modem responds <code>OK</code> immediately but the connection happens asynchronously so the status of the connection should be checked with <code>AT+W?</code> or <code>AT+W$</code>. The <strong>SSID</strong> and <strong>password</strong> are immediately stored in NVS regardless of whether they are valid or the connection was successful</td></tr> <tr><td><strong>+W$</strong></td> <td>Show Wi-Fi IP address</td> <td>Responds with the IP address allocated to the modem from the AP by DHCP. If the connection has not completed or has been unsuccessful the IP address returned will be <code>0.0.0.0</code></td></tr> <tr><td><strong>+W#</strong></td> <td>Show Wi-Fi MAC address</td> <td>Responds with the MAC address of the modem. No connection is required, the MAC address is always available</td></tr> <tr><td><strong>+W+</strong></td> <td>Reconnect to Wi-Fi AP</td> <td>Reconnects to the AP using the <strong>SSID</strong> and <strong>password</strong> stored in NVS. If the modem is already joined to the AP, the connection is first disconnected and then reconnected</td></tr> <tr><td><strong>+W-</strong></td> <td>Disconnect from Wi-Fi AP</td> <td>Disconnects from the AP</td></tr> <tr><td><strong>+B?</strong></td> <td>Query Baud Rate</td> <td>Responds with the current baud rate configured for the connection to the DTE</td></tr> <tr><td><strong>+B=n</strong></td> <td>Set Baud Rate</td> <td>Sets the current baud rate to a supported value closest to <em>n</em>. The supported speeds are 4800, 9600, 14400, 19200, 38400, 57600, 115200. After the command is entered there is a 5 second delay before the baud rate is changed to allow changes to be made on the DTE before the modem responds. The new baud rate is immediately stored in NVS</td></tr> <tr><td><strong>+T?</strong></td> <td>Query Telnet TERM environment variable</td> <td>Responds with the current string value of the TERM environment variable that will be used by the Telnet protocol layer when negotiating the <strong>TERMINAL-TYPE</strong> option. If no value has been set, or has been cleared, the default value <code>vt100</code> will be used</td></tr> <tr><td><strong>+T=ttt</strong></td> <td>Set Telnet TERM environment variable</td> <td>Sets the current string value of the TERM environment variable to <em>ttt</em>. The Telnet protocol layer will use this value when negotiating the <strong>TERMINAL-TYPE</strong> option. If the command includes no value and is given only as <code>AT+T=</code> then the TERM environment variable is cleared and the default value will be used in future. The new value is immediately stored in NVS.</td></tr></tbody></table> <h2 id="s-registers"><a href="#s-registers" class="header-anchor">#</a> 'S' Registers</h2> <p>There are a total of 51 'S' Registers reserved in the modem, <code>S0</code> to <code>S50</code>.</p> <p>Most of them are undefined and unused. The defined registers are set with default values but some registers are ignored as their purpose is typically not useful, this is indicated in the table below. Changing the value of a register that is ignored will have no effect on the operation of the modem.</p> <p>'S' Registers originally held only 8-bit (byte) values. In this implementation registers are 16-bit.</p> <h3 id="defined-s-registers"><a href="#defined-s-registers" class="header-anchor">#</a> Defined 'S' Registers</h3> <table><thead><tr><th>Register</th> <th>Description</th> <th>Range</th> <th>Default Value</th> <th>Used</th></tr></thead> <tbody><tr><td>S0</td> <td>Number of rings before Auto-Answer</td> <td>0–255 (0 = never)</td> <td>0</td> <td>Yes</td></tr> <tr><td>S1</td> <td>Ring Counter</td> <td>0–255 rings</td> <td>0</td> <td>Yes</td></tr> <tr><td>S2</td> <td>Escape character</td> <td>0–255, ASCII decimal</td> <td>43 ('+')</td> <td>Ignored</td></tr> <tr><td>S3</td> <td>Carriage Return Character</td> <td>0–127, ASCII decimal</td> <td>13 (Carriage Return)</td> <td>Ignored</td></tr> <tr><td>S4</td> <td>Line Feed Character</td> <td>0–127, ASCII decimal</td> <td>10 (Line Feed)</td> <td>Ignored</td></tr> <tr><td>S5</td> <td>Backspace Character</td> <td>0–32, ASCII decimal</td> <td>8 (Backspace)</td> <td>Ignored</td></tr> <tr><td>S14</td> <td>TCP/IP Port number for <strong>Answer Mode</strong></td> <td>0-65535</td> <td>23</td> <td>Yes</td></tr> <tr><td>S15</td> <td>Telnet Protocol  for <strong>Data Mode</strong></td> <td>0 - disabled, 1 - enabled</td> <td>0</td> <td>Yes</td></tr> <tr><td>S16</td> <td>Negotiate Telnet <strong>SGA</strong></td> <td>0 - Won't/Don't, 1 - Will, 2 - Do, 3 - Will/Do</td> <td>3</td> <td>Yes</td></tr> <tr><td>S17</td> <td>Negotiate Telnet <strong>ECHO</strong></td> <td>0 - Won't/Don't, 1 - Will, 2 - Do, 3 - Will/Do</td> <td>3</td> <td>Yes</td></tr> <tr><td>S18</td> <td>Negotiate Telnet <strong>BIN</strong></td> <td>0 - Won't/Don't, 1 - Will, 2 - Do, 3 - Will/Do</td> <td>0</td> <td>Yes</td></tr> <tr><td>S19</td> <td>Negotiate Telnet <strong>NAWS</strong></td> <td>0 - Won't/Don't, 1 - Will, 2 - Do, 3 - Will/Do</td> <td>3</td> <td>Yes</td></tr> <tr><td>S20</td> <td>NAWS Negotiate <strong>Columns</strong></td> <td>0-255 columns</td> <td>80</td> <td>Yes</td></tr> <tr><td>S21</td> <td>NAWS Negotiate <strong>Rows</strong></td> <td>0-255 rows</td> <td>24</td> <td>Yes</td></tr> <tr><td>S22</td> <td>Negotiate Telnet <strong>TERMINAL-TYPE</strong></td> <td>0 - Won't/Don't, 1 - Will, 2 - Do, 3 - Will/Do</td> <td>3</td> <td>Yes</td></tr> <tr><td>S39</td> <td>CTS/RTS Flow Control</td> <td>0 - disabled, 1 - enabled, set by <code>AT&amp;K</code> command</td> <td>0</td> <td>Yes</td></tr></tbody></table> <h2 id="wi-fi-connection-results"><a href="#wi-fi-connection-results" class="header-anchor">#</a> Wi-Fi Connection Results</h2> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>Wi-Fi <strong>cannot</strong> be started when the terminal is in <strong>30 line</strong> mode due to the limited amount of internal memory in the EPS32.</p> <p>If you attempt to (re)connect the Wi-Fi when in this mode you will receive the response: <code>WIFI ERROR</code></p> <p>Return the terminal to <strong>24 or 25 line</strong> mode and you will be able to (re)connect the Wi-Fi.</p></div> <h3 id="dial-responses"><a href="#dial-responses" class="header-anchor">#</a> Dial Responses</h3> <p>The following table details the responses from the modem for the <strong>Dial</strong> command <code>ATDhostname:port</code></p> <table><thead><tr><th>Response</th> <th>Reason for Response</th></tr></thead> <tbody><tr><td><code>NO DIALTONE</code></td> <td>when no Wi-Fi connection has been established with an AP</td></tr> <tr><td><code>ALREADY IN CALL</code></td> <td>when a connection is already established ('Dialed' or 'Answered') with another host</td></tr> <tr><td><code>ERROR</code></td> <td>when no <em>hostname</em> is provided</td></tr> <tr><td><code>NO ANSWER</code></td> <td>when a TCP/IP socket <strong>can't be opened</strong> with the <em>hostname:port</em></td></tr> <tr><td><code>CONNECT</code></td> <td>when a TCP/IP socket <strong>is opened</strong> with the <em>hostname:port</em></td></tr></tbody></table> <h3 id="query-wi-fi-responses"><a href="#query-wi-fi-responses" class="header-anchor">#</a> Query Wi-Fi Responses</h3> <p>The following table details the responses from the modem for the <strong>Query Wi-Fi Access Point (AP) connection status</strong> command <code>AT+W?</code></p> <table><thead><tr><th>Response</th> <th>Description</th></tr></thead> <tbody><tr><td><code>WIFI NOT STARTED</code></td> <td>when no Wi-Fi connection has been attempted since power-on or hardware reset</td></tr> <tr><td><code>WIFI IDLE</code></td> <td>if Wi-Fi status is queried during a connection attempt</td></tr> <tr><td><code>WIFI NO SSID</code></td> <td>when no AP with the given SSID/password is found following the <code>AT+W+</code> or <code>AT+W=</code> commands</td></tr> <tr><td><code>WIFI CONNECTED</code></td> <td>following a <strong>successful</strong> connection to an AP with the <code>AT+W+</code> or <code>AT+W=</code> commands</td></tr> <tr><td><code>WIFI CONNECT FAILED</code></td> <td>tba</td></tr> <tr><td><code>WIFI CONNECTION LOST</code></td> <td>following a lost connection with the AP</td></tr> <tr><td><code>WIFI DISCONNECTED</code></td> <td>following an <strong>unsuccessful</strong> connection attempt, or a <strong>successful</strong> disconnection with the <code>AT+W-</code> command</td></tr></tbody></table> <h2 id="telnet-protocol"><a href="#telnet-protocol" class="header-anchor">#</a> Telnet Protocol</h2> <p>The <a href="https://en.wikipedia.org/wiki/Telnet" target="_blank" rel="noopener noreferrer">Telnet protocol<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in normally considered an optional layer when establishing TCP/IP socket connections with remote hosts to operate as a Network Virtual Terminal (NVT).</p> <p>Some hosts will provide a more functional service if Telnet is negotiated.</p> <p>The Telnet daemon <code>telnetd</code> I have on MacOS won't accept a connection if Telnet is not negotiated.</p> <p>When Telnet is <strong>not enabled</strong>, TCP/IP socket connections are 8-bit clean. With Telnet <strong>enabled</strong> only one value, <code>0xFF</code> known as the IAC byte (Interpret As Command) is overloaded to indicate that the next byte is a Telnet command. Telnet must negotiate binary mode (BIN) to transmit binary files.</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>If connecting to a remote  <strong>c-Kermit server</strong> ie. under c-Kermit on a remote host enter the command <code>set host /server * 8080</code></p> <p><strong>DO NOT</strong> enable the Telnet protocol as you are not acting as an NVT in this use-case and c-Kermit doesn't expect Telnet.</p></div> <h3 id="telnet-options-implemented"><a href="#telnet-options-implemented" class="header-anchor">#</a> Telnet Options Implemented</h3> <p>The modem implements the following minimum set of Telnet <em>options</em>:</p> <ul><li><a href="https://tools.ietf.org/html/rfc858" target="_blank" rel="noopener noreferrer">SGA (Suppress Go Ahead)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://tools.ietf.org/html/rfc1073" target="_blank" rel="noopener noreferrer">ECHO<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://tools.ietf.org/html/rfc856" target="_blank" rel="noopener noreferrer">BIN (Binary Transmission)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://tools.ietf.org/html/rfc1073" target="_blank" rel="noopener noreferrer">NAWS (Negotiate About Window Size)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://tools.ietf.org/html/rfc1091" target="_blank" rel="noopener noreferrer">TERMINAL-TYPE<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Each Telnet <em>Option</em> is negotiated in via a request/response exchange described as Do/Don't (request) and Will/Won't (response). Trying to understand how these work for each <em>Option</em> usually requires reading the RFC (linked in the list above) and extreme patience and experimentation.</p> <p>Usually you either want an <em>Option</em> completely <strong>On</strong> (Do/Will) or <strong>Off</strong> (Don't/Won't).</p> <p>Setting the supported <em>Options</em> and their default values are defined via specific <a href="#defined-s-registers">'S' Registers detailed above</a>.</p> <p>In summary the defaults are:</p> <table><thead><tr><th>Option</th> <th>Default</th> <th>Description</th></tr></thead> <tbody><tr><td>SGA</td> <td>Do/Will</td> <td>SGA is required for the NVT to work character by character and not in linemode</td></tr> <tr><td>ECHO</td> <td>Do/Will</td> <td>tba</td></tr> <tr><td>BIN</td> <td>Don't/Won't</td> <td>To operate as an NVT, binary mode is not required. File transfer protocols like KERMIT and XMODEM do their own binary encoding</td></tr> <tr><td>NAWS</td> <td>Do/Will</td> <td>The remote host can learn your terminal windows size in characters, the default is <code>80 x 24</code> set in <code>S20</code> and <code>S21</code> respectively</td></tr> <tr><td>TERMINAL-TYPE</td> <td>Do/Will</td> <td>The remote host can learn your terminal type, the default is <code>vt100</code></td></tr></tbody></table> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>TERMINAL-TYPEs must be known by the remote system to be recognised.</p> <p>When connecting to <code>telnetd</code> on MacOS I use <code>vt100+</code> from the <code>terminfo</code> database which provides support for color over and above the standard <code>vt100</code> terminal type, making text applications like <code>htop</code> work as expected and in color.</p></div> <h3 id="enabling-telnet-protocol"><a href="#enabling-telnet-protocol" class="header-anchor">#</a> Enabling Telnet Protocol</h3> <p>Telnet protocol is <strong>not enabled</strong> by default.</p> <ul><li>To <strong>enable</strong> the Telnet protocol you must manually set 'S' Register <code>S15</code> to <code>1</code> with <code>ATS15=1</code></li> <li>To <strong>disable</strong> the Telnet protocol you must manually set 'S' Register <code>S15</code> to <code>0</code> with <code>ATS15=0</code></li></ul> <p>The Telnet protocol is applied to <strong>both</strong> <em>outgoing connections</em> 'Dialed' with <code>ATD</code> and <em>incoming connections</em> 'Answered' with <code>ATA</code> or <strong>Auto-answer</strong>.</p> <h3 id="telnet-protocol-framework"><a href="#telnet-protocol-framework" class="header-anchor">#</a> Telnet Protocol Framework</h3> <p>The Telnet protocol implementation in the modem is not fixed, but is instead based on a library <a href="https://github.com/seanmiddleditch/libtelnet" target="_blank" rel="noopener noreferrer">libtelnet<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. There is further information about Telnet and Telnet <em>Options</em> on the GitHub repository for the library.</p> <p>The library provides a framework for implementing any Telnet <em>Option</em>. So if there are <em>Options</em> that you feel are important beyond the minimum set already implemented let me know, providing a <em>compelling</em> use-case, and I will consider adding them.</p> <h2 id="answer-mode"><a href="#answer-mode" class="header-anchor">#</a> Answer Mode</h2> <p>Listening for incoming TCP/IP socket connections is <strong>not enabled</strong> by default.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Changes to the <code>AT&amp;A</code> command include: See <a href="#at-command-summary-table">'AT' Command Summary Table</a> above.</p> <ul><li><code>AT&amp;A0</code> is equivalent to <code>AT&amp;A</code> for <strong>interactive</strong> command mode use (as below)
<ul><li>Displays <code>RING</code> &amp; <code>CONNECTED</code> responses (if enabled)</li> <li>Allows the interrupt sequence <code>+++</code> to return the Modem to command mode from data mode</li></ul></li> <li><code>AT&amp;A1</code> is a new <strong>daemon</strong> mode - this mode avoids a race condition when the 'AT' Modem is used, for example, as the CP/M console device CON: and allows the Modem to be used to provide remote access to the console eg. from a telnet client
<ul><li>Suppresses 'AT' command echo and responses (sets <code>ATE0</code> &amp; <code>ATQ1</code>).</li> <li>Ignores the interrupt sequence <code>+++</code> preventing the Modem from returning to command mode from data mode</li> <li>Typically would be executed from a modem initialisation string</li></ul></li></ul></div> <ul><li>To <strong>enable</strong> listening for incoming TCP/IP socket connections you must manually enter <code>AT&amp;A</code> to <em>Enable Answer Mode</em>.</li> <li>Answer Mode will remain enabled, and can only disabled by an <code>ATZ</code> Soft Reset, hardware reset or power-cycle.</li> <li>Incoming TCP/IP socket connections will cause the modem to respond with <code>RING</code>, repeated every three (3) seconds.</li> <li>As each <code>RING</code> occurs the Ring Counter in <code>S1</code> is incremented by one (1).</li> <li>The user can <em>Answer</em> the incoming call at any time with <code>ATA</code> and the modem will accept the TCP/IP socket connection and enter <strong>Data Mode</strong>.</li> <li>If the <strong>Number of rings before Auto-Answer</strong> is set in <code>S0</code> to a number greater than zero (0 = never) and <code>S1</code> is greater-then-or-equal to <code>S0</code> the modem will <em>Auto-answer</em>: accept the TCP/IP socket connection and enter <strong>Data Mode</strong>.</li> <li>If Telnet protocol is enabled by <code>ATS15=1</code> then the Telnet Protocol will be negotiated with the remote host after the modem enters <strong>Data Mode</strong>.</li> <li>The user can <em>Hangup</em> an incoming call by sending the <em>Escape Sequence</em> <code>+++</code> (with guard times) to return to <strong>Command Mode</strong> and then sending <code>ATH</code> to <em>Hangup</em>.</li> <li>A Hangup <code>ATH</code> will reset the Ring Counter in <code>S1</code> to zero (0).</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/thehighnibble/thehighnibble.github.io/edit/vuepress/docs/vt132/operation/modem/README.md" target="_blank" rel="noopener noreferrer">Find a mistake? Got a suggestion? Edit this page.</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/10/2021, 5:21:43 AM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.a4ca7be3.js" defer></script><script src="/assets/js/23.285a1bb3.js" defer></script>
  </body>
</html>
